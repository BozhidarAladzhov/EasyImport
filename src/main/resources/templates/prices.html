<!DOCTYPE html>

<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="utf-8"/>
    <meta content="width=device-width, initial-scale=1" name="viewport"/>
    <title>Цени</title>
    <link href="/images/favicon-site.png" rel="icon" type="image/png"/>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet"/>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;800&amp;display=swap" rel="stylesheet"/>
    <link href="/css/site.css" rel="stylesheet"/>
    <link href="/css/prices.css" rel="stylesheet"/>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css" rel="stylesheet"/>
    <link href="https://cdn.jsdelivr.net/npm/tom-select/dist/css/tom-select.bootstrap5.min.css" rel="stylesheet"/>
</head>
<script>
    document.addEventListener('DOMContentLoaded', function () {
      document.querySelectorAll('.table tbody').forEach(function (tbody) {
        const rows = Array.from(tbody.querySelectorAll('tr'))
          .filter(r => r.querySelectorAll('td').length);

        let prevPort = null, currentGroup = [];

        function closeGroup() {
          if (!currentGroup.length) return;
          currentGroup.forEach(r => r.classList.add('port-group'));
          currentGroup[0].classList.add('port-group-start');
          currentGroup[currentGroup.length - 1].classList.add('port-group-end');
          currentGroup = [];
        }

        rows.forEach(function (row, i) {
          const portCell = row.cells[0];
          const port = (portCell?.textContent || '').trim();
          if (port !== prevPort) closeGroup();
          currentGroup.push(row);
          prevPort = port;
        });

        closeGroup(); // затваряме последната група
      });
    });
</script>
<body class="page-prices">
<nav class="navbar navbar-expand-lg">
    <div class="container">
        <a class="navbar-brand" th:href="@{/}">
            <div class="navbar-logo-wrapper">
                <img alt="Лого" class="navbar-logo" src="/images/Logo Bozhidar Aladzhov.svg"/>
            </div>
        </a>
        <button class="navbar-toggler" data-bs-target="#navbarNav" data-bs-toggle="collapse" type="button">
            <span class="navbar-toggler-icon"></span>
        </button>
        <div class="collapse navbar-collapse" id="navbarNav">
            <ul class="navbar-nav ms-auto">
                <li class="nav-item"><a class="nav-link" th:href="@{/}">Начало</a></li>
                <li class="nav-item"><a class="nav-link" th:href="@{/about}">За мен</a></li>
                <li class="nav-item"><a class="nav-link active" th:href="@{/prices}">Цени</a></li>
                <li class="nav-item"><a class="nav-link" th:href="@{/calculator}">Калкулатор</a></li>
                <li class="nav-item"><a class="nav-link" th:href="@{/process}">Процеси</a></li>
                <li class="nav-item"><a class="nav-link" th:href="@{/contact}">Контакти</a></li>
            </ul>
        </div>
    </div>
</nav>
<header class="hero hero--gradient">
    <div class="container hero-intro">
        <h2 class="fw-bold"><span class="highlight">Колко струва?</span></h2>
        <!--        <p class="fs-6 text-center">Проследи актуалните цени за морски транспорт.</p>-->
    </div>
</header>
<section class="section">
    <div class="container">
        <!-- Филтри -->
        <p class="fs-6">Избери товарно и разтоварно пристанище, за да видиш актуалните тарифи по дестинации.</p>
        <form class="row g-3 mb-4 form-shell hover-glow" method="get" th:action="@{/prices#results}">
            <input name="applied" type="hidden" value="1"/>
            <div class="col-md-4">
                <label class="form-label" for="originPort"><span class="highlight">Товарно пристанище</span></label>
                <select class="form-select" id="originPort" name="originPort">
                    <option value="">Избери</option>
                    <option th:each="port : ${originPortList}" th:selected="${port == selectedOriginPort}"
                            th:text="${port}" th:value="${port}"></option>
                </select>
            </div>
            <div class="col-md-4">
                <label class="form-label" for="portFilter"><span class="highlight">Разтоварно пристанище</span></label>
                <select class="form-select" id="portFilter" name="port">
                    <option value="">Избери</option>
                    <option th:selected="${selectedPort == 'Varna'}" value="Varna">Varna</option>
                    <option th:selected="${selectedPort == 'Rotterdam'}" value="Rotterdam">Rotterdam</option>
                </select>
            </div>
            <div class="col-md-2 d-flex align-items-end">
                <button class="btn w-100" type="submit">Приложи</button>
            </div>
            <div class="col-md-2 d-flex align-items-end">
                <a class="btn btn-outline w-100" th:href="@{/prices}">Изчисти</a>
            </div>
        </form>
        <!-- Резултати -->
        <div class="row" id="results" th:if="${param.applied != null}">
            <!-- До Варна -->
            <div class="col-md-6 mb-4">
                <div class="card h-100">
                    <div class="card-header bg-transparent border-0 px-3 pb-0">
                        <h4 class="card-title m-0">Доставки до Варна</h4>
                    </div>
                    <div class="card-body p-0">
                        <div class="table-responsive">
                            <table class="table table-hover mb-0">
                                <thead>
                                <tr>
                                    <th>От пристанище</th>
                                    <th>Вид автомобил</th>
                                    <th>Цена (USD)</th>
                                </tr>
                                </thead>
                                <tbody>
                                <tr th:each="price : ${pricesToVarna}">
                                    <td th:text="${price.originPort}">-</td>
                                    <td th:text="${price.vehicleType}">-</td>
                                    <td th:text="${#numbers.formatDecimal(price.price, 2, 2)}">0.00</td>
                                </tr>
                                <tr th:if="${#lists.isEmpty(pricesToVarna)}">
                                    <td class="text-muted" colspan="3">Няма данни за показване.</td>
                                </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>
            <!-- До Ротердам -->
            <div class="col-md-6 mb-4">
                <div class="card h-100">
                    <div class="card-header bg-transparent border-0 px-3 pb-0">
                        <h4 class="card-title m-0">Доставки до Ротердам</h4>
                    </div>
                    <div class="card-body p-0">
                        <div class="table-responsive">
                            <table class="table table-hover mb-0">
                                <thead>
                                <tr>
                                    <th>От пристанище</th>
                                    <th>Вид автомобил</th>
                                    <th>Цена (USD)</th>
                                </tr>
                                </thead>
                                <tbody>
                                <tr th:each="price : ${pricesToRotterdam}">
                                    <td th:text="${price.originPort}">-</td>
                                    <td th:text="${price.vehicleType}">-</td>
                                    <td th:text="${#numbers.formatDecimal(price.price, 2, 2)}">0.00</td>
                                </tr>
                                <tr th:if="${#lists.isEmpty(pricesToRotterdam)}">
                                    <td class="text-muted" colspan="3">Няма данни за показване.</td>
                                </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>
        </div><!-- /row -->
    </div>
</section>
<footer class="site-footer">
    <div class="container py-4 text-center">
        <div class="d-flex justify-content-center gap-3 mb-3">
            <a class="btn-social instagram" href="https://www.instagram.com/bojidar.aladjov/" target="_blank">
                <i class="bi bi-instagram"></i>
            </a>
            <a class="btn-social facebook" href="https://www.facebook.com/bozidar.aladzov" target="_blank">
                <i class="bi bi-facebook"></i>
            </a>
            <a class="btn-social linkedin" href="https://www.linkedin.com/in/bozhidar-aladzhov-90003b186/"
               target="_blank">
                <i class="bi bi-linkedin"></i>
            </a>
            <a class="btn-social discord" href="https://discord.gg/bwGDdFZddx" target="_blank">
                <i class="bi bi-discord"></i>
            </a>
            <a class="btn-social mail" href="mailto:easyimport.bg@gmail.com">
                <i class="bi bi-envelope-fill"></i>
            </a>
        </div>
        <small class="text-muted-ux">© 2025 Bozhidar Aladzhov – Всички права запазени.</small>
    </div>
</footer>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/tom-select/dist/js/tom-select.complete.min.js"></script>
<script>
    document.addEventListener('DOMContentLoaded', function(){
      if(document.getElementById('originPort')) new TomSelect('#originPort', { create:false, sortField:null, dropdownParent:'body'});
      if(document.getElementById('portFilter')) new TomSelect('#portFilter', { create:false, sortField:null, dropdownParent:'body'});
    });
</script>
<script>
    document.addEventListener('DOMContentLoaded', function () {
      // 1) Автоматично маркиране на елементи за анимация
      const autoSelectors = [
        '.section',                          // самите секции
        '.section .card',
        '.section .content p',
        '.section h2, .section h3, .section h4',
        '.form-shell',
        '.table',                            // добави и .reveal-rows в HTML ако искаш stagger по редове
        '.stats .stat',
        '.about__highlights li'
      ];

      // Маркираме секциите, за да могат вътрешните им елементи да се разбуждат
      document.querySelectorAll('.section').forEach(sec => sec.classList.add('reveal'));

      // Маркираме елементите по горните селектори
      autoSelectors.forEach(sel => {
        document.querySelectorAll(sel).forEach(el => {
          el.classList.add('reveal');
        });
      });

      // 2) Stagger групи – прилагаме върху редици/гридове
      const staggerGroups = [
        '.cards-equal .row, .cards-equal',
        '.process-steps .row',
        '.about__highlights',
        '.table.reveal-rows tbody'
      ];
      staggerGroups.forEach(groupSel => {
        document.querySelectorAll(groupSel).forEach(group => {
          group.classList.add('reveal-stagger');
          [...group.children].forEach((child, i) => {
            child.style.setProperty('--i', i);
          });
        });
      });

      // 3) IntersectionObserver
      const prefersReduced = window.matchMedia('(prefers-reduced-motion: reduce)').matches;
      if (prefersReduced) {
        // Без анимации – просто показваме всичко
        document.querySelectorAll('.reveal, .reveal-stagger').forEach(el => el.classList.add('is-visible'));
        return;
      }

      const io = new IntersectionObserver((entries) => {
        entries.forEach(entry => {
          if (entry.isIntersecting) {
            entry.target.classList.add('is-visible');
            // по избор: спираме да наблюдаваме, за да не се „ресетва“
            io.unobserve(entry.target);
          }
        });
      }, { rootMargin: '0px 0px -10% 0px', threshold: 0.15 });

      document.querySelectorAll('.reveal, .reveal-stagger, .section').forEach(el => io.observe(el));

      // 4) Лек косметичен бонус: таблиците да stagger-ват редовете
      document.querySelectorAll('.table').forEach(tb => tb.classList.add('reveal-rows'));
    });
</script>
</body>
</html>
